$ajax=function(n){if(this.formatParams=function(e){var n=[];for(var o in e)n.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return n.join("&")},"jsonpCallback"==(n=n||{}).dataType||"callback"==n.dataType){var o=("jsonp_"+Math.random()).replace(".",""),i=document.getElementsByTagName("head")[0];n.data[n.dataType]=o;var e=this.formatParams(n.data),t=document.createElement("script");i.appendChild(t),window[o]=function(e){i.removeChild(t),clearTimeout(t.timer),window[o]=null,n.success&&n.success(e)},t.src=n.url+"?"+e,n.time&&(t.timer=setTimeout(function(){window[o]=null,i.removeChild(t),n.fail&&n.fail({message:"超时"})},time))}else{e=this.formatParams(n.data);if(n.type=(n.type||"GET").toUpperCase(),n.dataType=n.dataType||"json",window.XMLHttpRequest)var r=new XMLHttpRequest;else r=new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4==r.readyState){var e=r.status;200<=e&&e<300?n.success&&n.success(r.responseText,r.responseXML):n.fail&&n.fail(e)}},"GET"==n.type?(r.open("GET",n.url+"?"+e,!0),r.send(null)):"POST"==n.type&&(r.open("POST",n.url,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(e))}},server=function(e,n,o){$ajax({url:e,type:"GET",dataType:"jsonpCallback",data:n||{},success:function(e){o&&o(e)},fail:function(e,n,o){}})},window.PGPromise=function(e){if(!(e instanceof Function))throw new Error("not a function");var o=this;this.status="pending",this.callbackArr=[],e&&e(function(n){o.callbackArr.forEach(function(e){e(n)}),o.status="end"})},window.PGPromise.prototype.then=function(e){if(!(e instanceof Function))throw new Error("not a function");return this.callbackArr.push(e),this},function(e,n){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return n(e)}):n(e,!0)}(this,function(t,e){function c(n,e,o){t.WeixinJSBridge?WeixinJSBridge.invoke(n,r(e),function(e){a(n,e,o)}):l(n,o)}function n(n,o,i){t.WeixinJSBridge?WeixinJSBridge.on(n,function(e){i&&i.trigger&&i.trigger(e),a(n,e,o)}):l(n,i||o)}function r(e){return(e=e||{}).appId=k.appId,e.verifyAppId=k.appId,e.verifySignType="sha1",e.verifyTimestamp=k.timestamp+"",e.verifyNonceStr=k.nonceStr,e.verifySignature=k.signature,e}function o(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function a(e,n,o){"openEnterpriseChat"==e&&(n.errCode=n.err_code),delete n.err_code,delete n.err_desc,delete n.err_detail;var i=n.errMsg;i||(i=n.err_msg,delete n.err_msg,i=function(e,n){var o=e,i=p[o];i&&(o=i);var t="ok";if(n){var r=n.indexOf(":");"confirm"==(t=n.substring(r+1))&&(t="ok"),"failed"==t&&(t="fail"),-1!=t.indexOf("failed_")&&(t=t.substring(7)),-1!=t.indexOf("fail_")&&(t=t.substring(5)),"access denied"!=(t=(t=t.replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=t||(t="permission denied"),"config"==o&&"function not exist"==t&&(t="ok"),""==t&&(t="fail")}return n=o+":"+t}(e,i),n.errMsg=i),(o=o||{})._complete&&(o._complete(n),delete o._complete),i=n.errMsg||"",k.debug&&!o.isInnerInvoke&&alert(JSON.stringify(n));var t=i.indexOf(":");switch(i.substring(t+1)){case"ok":o.success&&o.success(n);break;case"cancel":o.cancel&&o.cancel(n);break;default:o.fail&&o.fail(n)}o.complete&&o.complete(n)}function s(e){if(e){for(var n=0,o=e.length;n<o;++n){var i=e[n],t=f[i];t&&(e[n]=t)}return e}}function l(e,n){if(!(!k.debug||n&&n.isInnerInvoke)){var o=p[e];o&&(e=o),n&&n._complete&&delete n._complete,console.log('"'+e+'",',n||"")}}function u(){return(new Date).getTime()}function d(e){I&&(t.WeixinJSBridge?"preInject"===i.__wxjsjs__isPreInject?i.addEventListener&&i.addEventListener("WeixinJSBridgeReady",e,!1):e():i.addEventListener&&i.addEventListener("WeixinJSBridgeReady",e,!1))}if(!t.jWeixin){var f={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},p=function(){var e={};for(var n in f)e[f[n]]=n;return e}(),i=t.document,g=i.title,m=navigator.userAgent.toLowerCase(),h=navigator.platform.toLowerCase(),w=!(!h.match("mac")&&!h.match("win")),v=-1!=m.indexOf("wxdebugger"),I=-1!=m.indexOf("micromessenger"),S=-1!=m.indexOf("android"),y=-1!=m.indexOf("iphone")||-1!=m.indexOf("ipad"),P=(W=m.match(/micromessenger\/(\d+\.\d+\.\d+)/)||m.match(/micromessenger\/(\d+\.\d+)/))?W[1]:"",T={initStartTime:u(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},b={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:y?1:S?2:-1,clientVersion:P,url:encodeURIComponent(location.href)},k={},_={_completes:[]},M={state:0,data:{}};d(function(){T.initEndTime=u()});var A=!1,E=[],x={config:function(e){l("config",k=e);var i=!1!==k.check;d(function(){if(i)c(f.config,{verifyJsApiList:s(k.jsApiList)},function(){_._complete=function(e){T.preVerifyEndTime=u(),M.state=1,M.data=e},_.success=function(e){b.isPreVerifyOk=0},_.fail=function(e){_._fail?_._fail(e):M.state=-1};var i=_._completes;return i.push(function(){!function(e){if(!(w||v||k.debug||P<"6.0.2"||b.systemType<0)){var o=new Image;b.appId=k.appId,b.initTime=T.initEndTime-T.initStartTime,b.preVerifyTime=T.preVerifyEndTime-T.preVerifyStartTime,x.getNetworkType({isInnerInvoke:!0,success:function(e){b.networkType=e.networkType;var n="https://open.weixin.qq.com/sdk/report?v="+b.version+"&o="+b.isPreVerifyOk+"&s="+b.systemType+"&c="+b.clientVersion+"&a="+b.appId+"&n="+b.networkType+"&i="+b.initTime+"&p="+b.preVerifyTime+"&u="+b.url;o.src=n}})}}()}),_.complete=function(e){for(var n=0,o=i.length;n<o;++n)i[n]();_._completes=[]},_}()),T.preVerifyStartTime=u();else{M.state=1;for(var e=_._completes,n=0,o=e.length;n<o;++n)e[n]();_._completes=[]}}),x.invoke||(x.invoke=function(e,n,o){t.WeixinJSBridge&&WeixinJSBridge.invoke(e,r(n),o)},x.on=function(e,n){t.WeixinJSBridge&&WeixinJSBridge.on(e,n)})},ready:function(e){0!=M.state?e():(_._completes.push(e),!I&&k.debug&&e())},error:function(e){P<"6.0.2"||(-1==M.state?e(M.data):_._fail=e)},checkJsApi:function(e){c("checkJsApi",{jsApiList:s(e.jsApiList)},(e._complete=function(e){if(S){var n=e.checkResult;n&&(e.checkResult=JSON.parse(n))}e=function(e){var n=e.checkResult;for(var o in n){var i=p[o];i&&(n[i]=n[o],delete n[o])}return e}(e)},e))},onMenuShareTimeline:function(e){n(f.onMenuShareTimeline,{complete:function(){c("shareTimeline",{title:e.title||g,desc:e.title||g,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){n(f.onMenuShareAppMessage,{complete:function(){c("sendAppMessage",{title:e.title||g,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){n(f.onMenuShareQQ,{complete:function(){c("shareQQ",{title:e.title||g,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){n(f.onMenuShareWeibo,{complete:function(){c("shareWeiboApp",{title:e.title||g,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){n(f.onMenuShareQZone,{complete:function(){c("shareQZone",{title:e.title||g,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},startRecord:function(e){c("startRecord",{},e)},stopRecord:function(e){c("stopRecord",{},e)},onVoiceRecordEnd:function(e){n("onVoiceRecordEnd",e)},playVoice:function(e){c("playVoice",{localId:e.localId},e)},pauseVoice:function(e){c("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){c("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){n("onVoicePlayEnd",e)},uploadVoice:function(e){c("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){c("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){c("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){c("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(S){var n=e.localIds;n&&(e.localIds=JSON.parse(n))}},e))},getLocation:function(e){},previewImage:function(e){c(f.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){c("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){c("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===A?(A=!0,c("getLocalImgData",{localId:e.localId},(e._complete=function(e){if(A=!1,0<E.length){var n=E.shift();wx.getLocalImgData(n)}},e))):E.push(e)},getNetworkType:function(e){c("getNetworkType",{},(e._complete=function(e){e=function(e){var n=e.errMsg;e.errMsg="getNetworkType:ok";var o=e.subtype;if(delete e.subtype,o)e.networkType=o;else{var i=n.indexOf(":"),t=n.substring(i+1);switch(t){case"wifi":case"edge":case"wwan":e.networkType=t;break;default:e.errMsg="getNetworkType:fail"}}return e}(e)},e))},openLocation:function(e){c("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)},getLocation:function(e){e=e||{},c(f.getLocation,{type:e.type||"wgs84"},(e._complete=function(e){delete e.type},e))},hideOptionMenu:function(e){c("hideOptionMenu",{},e)},showOptionMenu:function(e){c("showOptionMenu",{},e)},closeWindow:function(e){c("closeWindow",{},e=e||{})},hideMenuItems:function(e){c("hideMenuItems",{menuList:e.menuList},e)},showMenuItems:function(e){c("showMenuItems",{menuList:e.menuList},e)},hideAllNonBaseMenuItem:function(e){c("hideAllNonBaseMenuItem",{},e)},showAllNonBaseMenuItem:function(e){c("showAllNonBaseMenuItem",{},e)},scanQRCode:function(e){c("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){if(y){var n=e.resultStr;if(n){var o=JSON.parse(n);e.resultStr=o&&o.scan_code&&o.scan_code.scan_result}}},e))},openAddress:function(e){c(f.openAddress,{},(e._complete=function(e){var n;(n=e).postalCode=n.addressPostalCode,delete n.addressPostalCode,n.provinceName=n.proviceFirstStageName,delete n.proviceFirstStageName,n.cityName=n.addressCitySecondStageName,delete n.addressCitySecondStageName,n.countryName=n.addressCountiesThirdStageName,delete n.addressCountiesThirdStageName,n.detailInfo=n.addressDetailInfo,delete n.addressDetailInfo,e=n},e))},openProductSpecificView:function(e){c(f.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)},addCard:function(e){for(var n=e.cardList,o=[],i=0,t=n.length;i<t;++i){var r=n[i],a={card_id:r.cardId,card_ext:r.cardExt};o.push(a)}c(f.addCard,{card_list:o},(e._complete=function(e){var n=e.card_list;if(n){for(var o=0,i=(n=JSON.parse(n)).length;o<i;++o){var t=n[o];t.cardId=t.card_id,t.cardExt=t.card_ext,t.isSuccess=!!t.is_succ,delete t.card_id,delete t.card_ext,delete t.is_succ}e.cardList=n,delete e.card_list}},e))},chooseCard:function(e){c("chooseCard",{app_id:k.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))},openCard:function(e){for(var n=e.cardList,o=[],i=0,t=n.length;i<t;++i){var r=n[i],a={card_id:r.cardId,code:r.code};o.push(a)}c(f.openCard,{card_list:o},e)},consumeAndShareCard:function(e){c(f.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)},chooseWXPay:function(e){c(f.chooseWXPay,o(e),e)},openEnterpriseRedPacket:function(e){c(f.openEnterpriseRedPacket,o(e),e)},startSearchBeacons:function(e){c(f.startSearchBeacons,{ticket:e.ticket},e)},stopSearchBeacons:function(e){c(f.stopSearchBeacons,{},e)},onSearchBeacons:function(e){n(f.onSearchBeacons,e)},openEnterpriseChat:function(e){c("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)},launchMiniProgram:function(e){c("launchMiniProgram",{targetAppId:e.targetAppId,path:function(e){if("string"==typeof e&&0<e.length){var n=e.split("?")[0],o=e.split("?")[1];return n+=".html",void 0!==o?n+"?"+o:n}}(e.path),envVersion:e.envVersion},e)},miniProgram:{navigateBack:function(e){c("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:(e=e||{}).delta||1}},e)},navigateTo:function(e){c("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)},redirectTo:function(e){c("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)},switchTab:function(e){c("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)},reLaunch:function(e){c("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)}}},C=1,V={};return i.addEventListener("error",function(e){if(!S){var n=e.target,o=n.tagName,i=n.src;if(("IMG"==o||"VIDEO"==o||"AUDIO"==o||"SOURCE"==o)&&-1!=i.indexOf("wxlocalresource://")){e.preventDefault(),e.stopPropagation();var t=n["wx-id"];if(t||(t=C++,n["wx-id"]=t),V[t])return;V[t]=!0,wx.ready(function(){wx.getLocalImgData({localId:i,success:function(e){n.src=e.localData}})})}}},!0),i.addEventListener("load",function(e){if(!S){var n=e.target,o=n.tagName;if(n.src,"IMG"==o||"VIDEO"==o||"AUDIO"==o||"SOURCE"==o){var i=n["wx-id"];i&&(V[i]=!1)}}},!0),e&&(t.wx=t.jWeixin=x),x}var W}),function(){function e(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=window.location.search.substr(1).match(n);return null!=o?decodeURIComponent(o[2]):null}window.PGNative={debug:!0,JsSDKversion:"0.0.1",deviceId:e("deviceId"),locale:e("locale"),platform:e("platform"),channel:e("channel"),appversion:e("appversion"),appname:e("appname"),geoinfo:e("geoinfo")};var r,n,o={},a=null,c={Default:{},Timeline:{}},i=o;document.addEventListener("PGJsSDK",function(e){console.log("PGJsSDK init success"),r=e.bridge,n=e.priviteKey},!1),PGNative.ready=function(e){try{r.init(o,function(e,n){n&&n(ret)})}catch(e){throw new Error("PG init fail")}finally{e&&e(o)}},i.checkJsApi=function(e,n){if(e.jsApiList){if(e.jsApiList.length<=0)throw new Error("checkJsApi list is empty!");for(var o=!1,i=0;i<e.jsApiList;i++)"shareUrl"==e.jsApiList[i]&&(o=!0);o||e.jsApiList.push("shareUrl"),r.callHandler("checkJsApi",e,function(e){n(e)})}},i.prompt=function(e,n){console.log("callHandler prompt"),r.callHandler("prompt",e,function(e){n(e)})},i.chooseImage=function(e,n){console.log("callHandler chooseImage"),r.callHandler("chooseImage",e,function(e){n(e)})},i.chooseC360Image=function(e,n){console.log("callHandler chooseC360Image"),r.callHandler("chooseC360Image",e,function(e){n(e)})},i.downloadImage=function(e,n){console.log("callHandler downloadImage"),r.callHandler("downloadImage",e,function(e){n(e)})},i.saveImage=function(e,n){console.log("callHandler saveImage"),r.callHandler("saveImage",e,function(e){n(e)})},i.uploadImage=function(e,n){console.log("callHandler uploadImage"),r.callHandler("uploadImage",e,function(e){n(e)})},i.showMenuItems=function(e,n){console.log("callHandler showMenuItems"),r.callHandler("showMenuItems",e,function(e){n(e)})},i.shareImage=function(e,n){console.log("callHandler shareImage"),r.callHandler("shareImage",e,function(e){n(e)})},i.showShareChannelsMenuActionSheet=function(e,n){console.log("callHandler showShareChannelsMenuActionSheet"),r.callHandler("showShareChannelsMenuActionSheet",e,function(e){n(e)})},i.shareUrl=function(e,n){console.log("callHandler shareUrl"),r.callHandler("shareUrl",e,function(e){n(e)})},i.changeShareChanelText=function(e){e.constructor==Object&&(a=e)},i.triggerAlipay=function(e,n){console.log("callHandler triggerAlipay"),r.callHandler("triggerAlipay",e,function(e){n(e)})},i.triggerWechatPay=function(e,n){console.log("callHandler triggerWechatPay"),r.callHandler("triggerWechatPay",e,function(e){n(e)})},i.createSignature=function(e,n){console.log("callHandler createSignature"),r.callHandler("createSignature",e,function(e){n(e)})},i.getNativeInfo=function(e,n){console.log("callHandler getNativeInfo"),r.callHandler("getNativeInfo",e,function(e){n(e)})},i.login=function(e,n){console.log("callHandler login"),r.callHandler("login",e,function(e){n(e)})},i.logout=function(e,n){console.log("callHandler logout"),r.callHandler("logout",e,function(e){n(e)})},i.configToolBar=function(e,n){console.log("callHandler configToolBar"),r.callHandler("configToolBar",e,function(e){n(e)})},i.configReturnBtn=function(e,n){console.log("callHandler configReturnBtn"),r.callHandler("configReturnBtn",e,function(e){n(e)})},i.doWebViewEnableBounceVertical=function(e,n){console.log("callHandler doWebViewEnableBounceVertical"),r.callHandler("doWebViewEnableBounceVertical",e,function(e){n(e)})},i.onWebShareDefault=function(e){if(console.log("call onWebShareDefault"),!(e instanceof Object))throw new Error("onWebShareDefault: param must instanceof Object");for(var n in e)c.Default[n]=e[n]},i.onWebShareTimeline=function(e){if(console.log("call onWebShareTimeline"),!(e instanceof Object))throw new Error("onWebShareTimeline: param must instanceof Object");for(var n in e)c.Timeline[n]=e[n]};var s=null;i._invokeWebShare=function(i){console.log("native call _invokeWebShare");var t="";if(t=0<=i.indexOf("channel")?JSON.parse(decodeURIComponent(i)).channel:i,this!==n)throw new Error("warning: call this private method is not allowed!");void 0!==window.triggerChannel&&window.triggerChannel(t),setTimeout(function(){var n="wechatMoments"==i?c.Timeline:c.Default;if(s||(s=JSON.parse(JSON.stringify(n))),n.title="wechatMoments"==t?s.desc:s.title,a&&void 0!==a[t])for(var e in a[t])n[e]=a[t][e];var o={channel:i,shareData:n};r.callHandler("shareUrl",o,function(e){n.callback&&n.callback()})},50)}}(),function(){var i={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/AppleWebKit/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone")||-1<e.indexOf("Mac"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari")}}()};if(!window.WebViewJavascriptBridge){var t,r=[],a=[],c={},s="wvjbscheme",l="__WVJB_QUEUE_MESSAGE__",u={},d=1,f=null;priviteKey=new Object,window.WebViewJavascriptBridge={init:function(e,n){if(f=e,WebViewJavascriptBridge._messageHandler)throw new Error("PGBridge.init called twice");WebViewJavascriptBridge._messageHandler=n;var o=a;a=null;for(var i=0;i<o.length;i++)g(o[i])},send:function(e,n){console.log("PGJsSDK call _send"),p({data:e},n)},registerHandler:function(e,n){console.log("PGJsSDK call registerHandler"),c[e]=n},callHandler:function(e,n,o){console.log("PGJsSDK call callHandler"),p({handlerName:e,data:n},o)},_fetchQueue:function(){console.log("PGJsSDK call _fetchQueue");var e=JSON.stringify(r);if(r=[],!i.versions.android)return e;window.PinguoNativeAdr.setQueue(e)},_handleMessageFromObjC:function(e){console.log("PGJsSDK call _handleMessageFromObjC"),a?a.push(e):g(e)},_handleWebShare:function(e){if(!e)throw new Error("param needed in _handleWebShare");console.log("PGJsSDK call _handleWebShare"),f&&f._invokeWebShare.call(priviteKey,e)}};var e,n=document;i.versions.ios&&((t=(e=n).createElement("iframe")).style.display="none",t.src=s+"://"+l,e.documentElement.appendChild(t));var o=n.createEvent("Events");o.initEvent("PGJsSDK","",""),o.bridge=WebViewJavascriptBridge,o.priviteKey=priviteKey,n.dispatchEvent(o)}function p(e,n){if(console.log("PGJsSDK call _doSend"),n){var o="cb_"+d+++"_"+(new Date).getTime();u[o]=n,e.callbackId=o}if(r.push(e),i.versions.android){if(!window.PinguoNativeAdr)throw new Error("Can not find PinguoNativeAdr in android");window.PinguoNativeAdr.sendSignalToAdr()}else i.versions.ios&&(t.src=s+"://"+l)}function g(t){console.log("PGJsSDK call _dispatchMessageFromObjC"),setTimeout(function(){var n=JSON.parse(t);if(n.responseId){if(!(e=u[n.responseId]))return;e(n.responseData),delete u[n.responseId]}else{var e;if(n.callbackId){var o=n.callbackId;e=function(e){p({responseId:o,responseData:e})}}var i=WebViewJavascriptBridge._messageHandler;n.handlerName&&(i=c[n.handlerName]);try{i(n.data,e)}catch(e){"undefined"!=typeof console&&console.log("PGBridge: WARNING: javascript handler threw.",n,e)}}})}}(),function(){window.PG={};var i=window.PG;i.Promise=window.PGPromise,i.server=window.PGServer;var o={};function e(e){server(e,{url:location.href.split("#")[0]},function(e){var n;200==e.status?(n=e.data,wx.config({debug:!1,appId:n.appid,timestamp:n.timestamp,nonceStr:n.noncestr,signature:n.sha1Str,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]})):i.log("获取票据失败")}),wx.error(function(e){"function not exist"==e.errMsg?i.log("微信提示：请更新最新版本"):i.log(e)})}function t(){return"wx"==i.config.channel.toLowerCase()}i.config={mode:"dev",channel:"wx",appName:"",WXRegisterUrl:location.protocol+"://share.camera360.com/wechat/oauth/getSignature",debug:!1},i.log=function(e){this.config.debug&&this.config.mode},i.setConfig=function(e){if(!(e instanceof Object))throw new Error("setConfig 参数必须是对象");for(var n in e)this.config[n]=e[n]},i.getConfig=function(){return this.config};var n=o,r=null;i.ready=function(){return new i.Promise(function(n){t()?(e(i.config.WXRegisterUrl),wx.ready(function(){n&&n(o)})):window.setTimeout(function(){window.PGNative.ready(function(e){r=e,n&&n(o)})},0)})},n.checkJsApi=function(e){return new i.Promise(function(n){t()?wx.checkJsApi({jsApiList:e.jsApiList,success:function(e){n&&n({status:200,message:"ok",checkResult:e.checkResult})}}):r.checkJsApi(e,n)})},n.showMenuItems=function(e){return new i.Promise(function(n){if(t())wx.showMenuItems({success:function(e){n({status:200,message:"ok"})}});else{if(!e)throw new Error("需要菜单列表参数");r.showMenuItems(e,n)}})},n.hideMenuItems=function(e){return new i.Promise(function(n){t()&&(e.success=function(e){n({status:200,message:"ok"})},wx.hideMenuItems(e))})},n.navigateBack=function(){wx.navigateBack()},n.chooseImage=function(o){return new i.Promise(function(n){if(t())wx.chooseImage({success:function(e){o instanceof Function&&1==arguments.length?o({status:200,message:"ok",localIds:e.localIds}):n({status:200,message:"ok",localIds:e.localIds})}});else{if(!o)throw new Error("需要图片参数");r.chooseImage(o,n)}})},n.chooseC360Image=function(n){return new i.Promise(function(e){if(!n)throw new Error("需要图片参数");r.chooseC360Image(n,e)})},n.uploadImage=function(e){return new i.Promise(function(n){t()?wx.uploadImage({localId:e.localId,isShowProgressTips:0,success:function(e){n({status:200,message:"ok",serverId:e.serverId})}}):r.uploadImage(e,n)})},n.downloadImage=function(e){return new i.Promise(function(n){t()?wx.downloadImage({serverId:e.url,isShowProgressTips:0,success:function(e){n({status:200,message:"ok",localId:e.localId})}}):r.downloadImage(e,n)})},n.saveImage=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持saveImage");r.saveImage(n,e)})},n.shareImage=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持shareImage");r.shareImage(n,e)})},n.showShareChannelsMenuActionSheet=function(n){return new i.Promise(function(e){if(t())throw new Error("showShareChannelsMenuActionSheet");r.showShareChannelsMenuActionSheet(n,e)})},n.shareUrl=function(n){return new i.Promise(function(e){if(t())throw new Error("shareUrl");r.shareUrl(n,e)})},n.aliPay=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持aliPay");r.triggerAlipay(n,e)})},n.changeShareChanelText=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持changeShareChanelText");r.changeShareChanelText(n,e)})},n.wechatPay=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持wechatPay");r.triggerWechatPay(n,e)})},n.createSignature=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持createSignature");r.createSignature(n,e)})},n.getNativeInfo=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持getNativeInfo");r.getNativeInfo(n||{},e)})},n.login=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持login");r.login(n||{},e)})},n.logout=function(n){return new i.Promise(function(e){if(t())throw new Error("logout");r.logout(n||{},e)})},n.configToolBar=function(n){return new i.Promise(function(e){if(t())throw new Error("configToolBar");r.configToolBar(n||{},e)})},n.configReturnBtn=function(n){return new i.Promise(function(e){if(t())throw new Error("configReturnBtn");r.configReturnBtn(n||{},e)})},n.doWebViewEnableBounceVertical=function(n){return new i.Promise(function(e){if(t())throw new Error("doWebViewEnableBounceVertical");r.doWebViewEnableBounceVertical(n||{},e)})},n.onWebShareDefault=function(o){return new i.Promise(function(e){if(t()){var n=null;o.success&&(n=o.success),o.success=function(e){n&&n(e)},wx.onMenuShareAppMessage(o)}else{n=null;o.success&&(n=o.success);o.callback=function(e){n&&n(e)},r.onWebShareDefault(o)}})},n.onWebShareTimeline=function(o){return new i.Promise(function(e){if(t()){var n=null;o.success&&(n=o.success),o.success=function(e){n&&n(e)},wx.onMenuShareTimeline(o)}else{n=null;o.success&&(n=o.success);o.callback=function(e){n&&n(e)},r.onWebShareTimeline(o)}})},n.prompt=function(n){return new i.Promise(function(e){if(t())throw new Error("微信不支持prompt");r.prompt(n,e)})}}();